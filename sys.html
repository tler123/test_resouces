<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年度 高一信資訊科技 第一次測驗</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #1a3a8f 0%, #2c5aa0 100%);
            color: white;
            padding: 25px 30px;
            border-bottom: 4px solid #ffc107;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        h1 i {
            margin-right: 15px;
            color: #ffc107;
        }
        
        .main-content {
            display: flex;
            min-height: 700px;
        }
        
        .file-explorer {
            flex: 0 0 300px;
            background-color: #f8f9fa;
            border-right: 1px solid #eaeaea;
            padding: 20px 0;
            overflow-y: auto;
        }
        
        .file-tree {
            list-style: none;
        }
        
        .file-item {
            padding: 12px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            border-left: 4px solid transparent;
        }
        
        .file-item:hover {
            background-color: #eef2ff;
        }
        
        .file-item.active {
            background-color: #e8edff;
            border-left-color: #1a3a8f;
            font-weight: 600;
        }
        
        .file-icon {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .file-name {
            font-size: 1rem;
        }
        
        .file-content {
            flex: 1;
            padding: 30px;
            min-height: 700px;
            display: flex;
            flex-direction: column;
        }
        
        .file-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .file-title {
            font-size: 1.8rem;
            color: #1a3a8f;
        }
        
        .file-path {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .copy-all-btn {
            background-color: #2c5aa0;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .copy-all-btn:hover {
            background-color: #1a3a8f;
        }
        
        .copy-all-btn i {
            margin-right: 8px;
        }
        
        .file-preview-container {
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
            border-radius: 8px;
            border: 1px solid #eaeaea;
            overflow: hidden;
            min-height: 100px;
            max-height: 250px;
            margin-bottom: 15px;
        }
        
        .preview-header {
            padding: 12px 15px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #eaeaea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .preview-stats {
            font-size: 0.85rem;
            color: #666;
        }
        
        .file-preview {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-all;
            font-size: 0.9rem;
            line-height: 1.4;
            background-color: #ffffff;
            color: #333333;
            margin: 0;
            overflow-x: auto;
        }
        
        .large-file-warning {
            padding: 20px;
            text-align: center;
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            margin-top: 15px;
            color: #856404;
            font-size: 0.95rem;
        }
        
        .large-file-warning i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #f39c12;
            display: block;
        }
        
        .sample-info {
            margin-top: 15px;
            padding: 12px;
            background-color: #eef7ff;
            border-radius: 6px;
            border-left: 4px solid #2c5aa0;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .error {
            color: #e74c3c;
            padding: 15px;
            text-align: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .directory {
            font-weight: 600;
            color: #1a3a8f;
        }
        
        .input-file {
            color: #d35400;
        }
        
        .output-file {
            color: #27ae60;
        }
        
        .pdf-file {
            color: #e74c3c;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .file-explorer {
                flex: none;
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #eaeaea;
                max-height: 300px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .file-content {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .copy-all-btn {
                width: 100%;
                justify-content: center;
            }
            
            .file-preview-container {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-folder-open"></i> 2025年度 高一信資訊科技 OI 賽制練習</h1>
        </header>
        
        <div class="main-content">
            <div class="file-explorer">
                <ul class="file-tree">
                    <!-- 檔案列表將由JavaScript動態生成 -->
                </ul>
            </div>
            
            <div class="file-content">
                <div class="file-header">
                    <div>
                        <h2 class="file-title" id="file-title">選擇檔案</h2>
                        <div class="file-path" id="file-path"></div>
                    </div>
                    <div class="action-buttons" id="action-buttons" style="display: none;">
                        <button class="copy-all-btn" id="copy-all-btn">
                            <i class="fas fa-copy"></i> 複製全部
                        </button>
                    </div>
                </div>
                
                <div class="file-preview-container" id="file-preview-container" style="display: none;">
                    <div class="preview-header">
                        <div>檔案內容</div>
                        <div class="preview-stats" id="preview-stats"></div>
                    </div>
                    <div class="file-preview" id="file-preview"></div>
                </div>
                
                <div class="large-file-warning" id="large-file-warning" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3 style="margin: 10px 0;">檔案太大</h3>
                    <p style="margin-bottom: 10px;">此檔案超過20000字元，無法顯示預覽。</p>
                </div>
                
                <div class="sample-info" id="sample-info" style="display: none;">
                    此檔案為樣例測試資料，您可以複製內容到您的程式進行測試。
                </div>
                
                <div class="error" id="error" style="display: none;"></div>
                
                <div id="no-file-selected" style="text-align: center; padding: 50px; color: #666;">
                    <i class="fas fa-file-alt" style="font-size: 3rem; margin-bottom: 20px; color: #ddd;"></i>
                    <h3 style="color: #999;">請從左側選擇一個檔案</h3>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification" style="display: none; position: fixed; bottom: 20px; right: 20px; background-color: #27ae60; color: white; padding: 15px 25px; border-radius: 6px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); align-items: center; z-index: 1000;">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">已複製到剪貼簿</span>
    </div>

    <script>
        // 定義四題的樣例檔案路徑（與HTML同一目錄）
        const FILE_CONFIG = {
            // 計算 (calc) 樣例
            calc: [
                'calc/calc1.in', 'calc/calc1.ans',
                'calc/calc2.in', 'calc/calc2.ans',
                'calc/calc3.in', 'calc/calc3.ans'
            ],
            
            // 牛奶 (milk) 樣例
            milk: [
                'milk/milk1.in', 'milk/milk1.ans',
                'milk/milk2.in', 'milk/milk2.ans',
                'milk/milk3.in', 'milk/milk3.ans',
                'milk/milk4.in', 'milk/milk4.ans',
                'milk/milk5.in', 'milk/milk5.ans',
                'milk/milk6.in', 'milk/milk6.ans',
                'milk/milk7.in', 'milk/milk7.ans'
            ],
            
            // 猜分數 (guess) 樣例
            guess: [
                'guess/guess1.in', 'guess/guess1.ans',
                'guess/guess2.in', 'guess/guess2.ans',
                'guess/guess3.in', 'guess/guess3.ans',
                'guess/guess4.in', 'guess/guess4.ans',
                'guess/guess5.in', 'guess/guess5.ans',
                'guess/guess6.in', 'guess/guess6.ans',
                'guess/guess7.in', 'guess/guess7.ans',
                'guess/guess8.in', 'guess/guess8.ans',
                'guess/guess9.in', 'guess/guess9.ans',
                'guess/guess10.in', 'guess/guess10.ans'
            ],
            
            // 檢查作業 (check) 樣例
            check: [
                'check/check1.in', 'check/check1.ans',
                'check/check2.in', 'check/check2.ans',
                'check/check3.in', 'check/check3.ans',
                'check/check4.in', 'check/check4.ans',
                'check/check5.in', 'check/check5.ans',
                'check/check6.in', 'check/check6.ans'
            ]
        };

        const fileTree = document.querySelector('.file-tree');
        const fileTitle = document.getElementById('file-title');
        const filePath = document.getElementById('file-path');
        const actionButtons = document.getElementById('action-buttons');
        const copyAllBtn = document.getElementById('copy-all-btn');
        const filePreviewContainer = document.getElementById('file-preview-container');
        const filePreview = document.getElementById('file-preview');
        const previewStats = document.getElementById('preview-stats');
        const largeFileWarning = document.getElementById('large-file-warning');
        const sampleInfo = document.getElementById('sample-info');
        const error = document.getElementById('error');
        const noFileSelected = document.getElementById('no-file-selected');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');

        let currentFile = null;
        let fileContent = '';

        function buildFileUrl(filename) {
            // 與HTML同一目錄
            return filename;
        }

        function initFileTree() {
            fileTree.innerHTML = '';
            
            // 添加四個題目的資料夾
            for (const [folderName, files] of Object.entries(FILE_CONFIG)) {
                const folderItem = document.createElement('li');
                folderItem.className = 'file-item directory';
                folderItem.innerHTML = `
                    <div class="file-icon">
                        <i class="fas fa-folder"></i>
                    </div>
                    <div class="file-name">${folderName}</div>
                `;
                
                folderItem.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleFolder(folderItem, folderName, files);
                });
                
                fileTree.appendChild(folderItem);
            }
        }

        function toggleFolder(folderElement, folderName, files) {
            const isExpanded = folderElement.classList.contains('expanded');
            
            // 收起其他已展開的資料夾
            document.querySelectorAll('.file-item.expanded').forEach(item => {
                if (item !== folderElement) {
                    item.classList.remove('expanded');
                    const nextSibling = item.nextElementSibling;
                    if (nextSibling && nextSibling.classList.contains('folder-children')) {
                        nextSibling.remove();
                    }
                }
            });
            
            if (isExpanded) {
                // 如果已經展開，則收起
                folderElement.classList.remove('expanded');
                const childrenContainer = folderElement.nextElementSibling;
                if (childrenContainer && childrenContainer.classList.contains('folder-children')) {
                    childrenContainer.remove();
                }
            } else {
                // 如果未展開，則展開
                folderElement.classList.add('expanded');
                
                const childrenContainer = document.createElement('div');
                childrenContainer.className = 'folder-children';
                childrenContainer.style.paddingLeft = '20px';
                
                files.forEach(fileName => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.setAttribute('data-path', fileName);
                    
                    let icon = 'fa-file';
                    let className = '';
                    let displayName = fileName.split('/').pop();
                    
                    if (fileName.endsWith('.in')) {
                        icon = 'fa-file-import';
                        className = 'input-file';
                    } else if (fileName.endsWith('.ans')) {
                        icon = 'fa-file-export';
                        className = 'output-file';
                    }
                    
                    fileItem.innerHTML = `
                        <div class="file-icon">
                            <i class="fas ${icon} ${className}"></i>
                        </div>
                        <div class="file-name ${className}">${displayName}</div>
                    `;
                    
                    fileItem.addEventListener('click', () => selectFile(fileName, displayName));
                    childrenContainer.appendChild(fileItem);
                });
                
                folderElement.parentNode.insertBefore(childrenContainer, folderElement.nextSibling);
            }
        }

        async function selectFile(path, displayName) {
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const fileItem = document.querySelector(`[data-path="${path}"]`);
            if (fileItem) {
                fileItem.classList.add('active');
            }
            
            resetPreview();
            
            fileTitle.textContent = displayName;
            filePath.textContent = `檔案: ${path}`;
            
            await loadFileContent(path, displayName);
        }

        async function loadFileContent(filePath, displayName) {
            try {
                const fileUrl = buildFileUrl(filePath);
                const response = await fetch(fileUrl);
                
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('檔案不存在');
                    } else {
                        throw new Error(`無法讀取檔案`);
                    }
                }
                
                fileContent = await response.text();
                const fileSize = response.headers.get('content-length') || fileContent.length;
                
                displayFileContent(fileContent, fileSize, displayName);
                actionButtons.style.display = 'flex';
                sampleInfo.style.display = 'block';
                
            } catch (err) {
                showError(`無法載入檔案 ${displayName}`, err, filePath);
                console.error('檔案載入錯誤:', err);
            }
        }

        function displayFileContent(content, fileSize, filename) {
            const lines = content.split('\n').length;
            const chars = content.length;
            const sizeKB = Math.round(fileSize / 1024 * 100) / 100;
            
            previewStats.textContent = `${lines}行 ${chars}字元 ${sizeKB}KB`;
            
            // 檢查是否超過20000字元（行數不限）
            if (chars > 20000) {
                // 檔案太大，不顯示預覽
                filePreviewContainer.style.display = 'none';
                largeFileWarning.style.display = 'block';
            } else {
                // 檔案在限制內，顯示預覽
                largeFileWarning.style.display = 'none';
                filePreviewContainer.style.display = 'flex';
                filePreview.textContent = content;
            }
        }

        function showError(message, err, filename) {
            error.style.display = 'block';
            error.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <i class="fas fa-exclamation-triangle"></i> ${message}
                </div>
                <div style="font-size: 0.9rem; color: #666;">
                    檔案: ${filename}
                </div>
            `;
            
            filePreviewContainer.style.display = 'none';
            largeFileWarning.style.display = 'none';
            actionButtons.style.display = 'none';
            sampleInfo.style.display = 'none';
        }

        function resetPreview() {
            filePreview.textContent = '';
            previewStats.textContent = '';
            filePreviewContainer.style.display = 'none';
            largeFileWarning.style.display = 'none';
            error.style.display = 'none';
            noFileSelected.style.display = 'none';
        }

        copyAllBtn.addEventListener('click', async () => {
            if (fileContent) {
                try {
                    await navigator.clipboard.writeText(fileContent);
                    
                    notificationText.textContent = '已複製到剪貼簿';
                    notification.style.display = 'flex';
                    
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 2500);
                } catch (err) {
                    const textarea = document.createElement('textarea');
                    textarea.value = fileContent;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    
                    notificationText.textContent = '已複製到剪貼簿';
                    notification.style.display = 'flex';
                    
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 2500);
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            initFileTree();
        });
    </script>
</body>
</html>