<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年度 算法入門C++ 第一次測驗</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #1a3a8f 0%, #2c5aa0 100%);
            color: white;
            padding: 25px 30px;
            border-bottom: 4px solid #ffc107;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        h1 i {
            margin-right: 15px;
            color: #ffc107;
        }
        
        .main-content {
            display: flex;
            min-height: 700px;
        }
        
        .file-explorer {
            flex: 0 0 300px;
            background-color: #f8f9fa;
            border-right: 1px solid #eaeaea;
            padding: 20px 0;
            overflow-y: auto;
        }
        
        .file-tree {
            list-style: none;
        }
        
        .file-item {
            padding: 12px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            border-left: 4px solid transparent;
        }
        
        .file-item:hover {
            background-color: #eef2ff;
        }
        
        .file-item.active {
            background-color: #e8edff;
            border-left-color: #1a3a8f;
            font-weight: 600;
        }
        
        .file-icon {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .file-name {
            font-size: 1rem;
        }
        
        .pdf-link-item {
            padding: 12px 25px;
            display: flex;
            align-items: center;
            border-left: 4px solid transparent;
        }
        
        .pdf-link-item:hover {
            background-color: #eef2ff;
        }
        
        .pdf-link {
            color: #e74c3c;
            text-decoration: none;
            display: flex;
            align-items: center;
            width: 100%;
        }
        
        .pdf-link:hover {
            text-decoration: underline;
        }
        
        .file-content {
            flex: 1;
            padding: 30px;
            min-height: 700px;
            display: flex;
            flex-direction: column;
        }
        
        .file-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .file-title {
            font-size: 1.8rem;
            color: #1a3a8f;
        }
        
        .file-path {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .copy-all-btn {
            background-color: #2c5aa0;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .copy-all-btn:hover {
            background-color: #1a3a8f;
        }
        
        .copy-all-btn i {
            margin-right: 8px;
        }
        
        .file-preview-container {
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
            border-radius: 8px;
            border: 1px solid #eaeaea;
            overflow: hidden;
            min-height: 100px;
            max-height: 250px;
            margin-bottom: 15px;
        }
        
        .preview-header {
            padding: 12px 15px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #eaeaea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .preview-stats {
            font-size: 0.85rem;
            color: #666;
        }
        
        .file-preview {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-all;
            font-size: 0.9rem;
            line-height: 1.4;
            background-color: #ffffff;
            color: #333333;
            margin: 0;
            overflow-x: auto;
        }
        
        .large-file-warning {
            padding: 20px;
            text-align: center;
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            margin-top: 15px;
            color: #856404;
            font-size: 0.95rem;
        }
        
        .large-file-warning i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #f39c12;
            display: block;
        }
        
        .sample-info {
            margin-top: 15px;
            padding: 12px;
            background-color: #eef7ff;
            border-radius: 6px;
            border-left: 4px solid #2c5aa0;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150px;
            font-size: 1.1rem;
            color: #666;
            flex-shrink: 0;
        }
        
        .loading i {
            margin-right: 10px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            color: #e74c3c;
            padding: 15px;
            text-align: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .directory {
            font-weight: 600;
            color: #1a3a8f;
        }
        
        .input-file {
            color: #d35400;
        }
        
        .output-file {
            color: #27ae60;
        }
        
        .pdf-file {
            color: #e74c3c;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .file-explorer {
                flex: none;
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #eaeaea;
                max-height: 300px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .file-content {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .copy-all-btn {
                width: 100%;
                justify-content: center;
            }
            
            .file-preview-container {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-folder-open"></i> 2025年度 算法入門C++ 第一次測驗</h1>
        </header>
        
        <div class="main-content">
            <div class="file-explorer">
                <ul class="file-tree">
                    <!-- 檔案列表將由JavaScript動態生成 -->
                </ul>
            </div>
            
            <div class="file-content">
                <div class="file-header">
                    <div>
                        <h2 class="file-title" id="file-title">選擇檔案</h2>
                        <div class="file-path" id="file-path"></div>
                    </div>
                    <div class="action-buttons" id="action-buttons" style="display: none;">
                        <button class="copy-all-btn" id="copy-all-btn">
                            <i class="fas fa-copy"></i> 複製全部
                        </button>
                    </div>
                </div>
                
                <div class="file-preview-container" id="file-preview-container" style="display: none;">
                    <div class="preview-header">
                        <div>檔案內容</div>
                        <div class="preview-stats" id="preview-stats"></div>
                    </div>
                    <div class="file-preview" id="file-preview"></div>
                </div>
                
                <div class="large-file-warning" id="large-file-warning" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3 style="margin: 10px 0;">檔案太大</h3>
                    <p style="margin-bottom: 10px;">此檔案超過20000字元，無法顯示預覽。</p>
                </div>
                
                <div class="sample-info" id="sample-info" style="display: none;">
                    此檔案為樣例測試資料，您可以複製內容到您的程式進行測試。
                </div>
                
                <div class="loading" id="loading" style="display: none;">
                    <i class="fas fa-spinner"></i> 正在載入檔案
                </div>
                
                <div class="error" id="error" style="display: none;"></div>
                
                <div id="no-file-selected" style="text-align: center; padding: 50px; color: #666;">
                    <i class="fas fa-file-alt" style="font-size: 3rem; margin-bottom: 20px; color: #ddd;"></i>
                    <h3 style="color: #999;">請從左側選擇一個檔案</h3>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification" style="display: none; position: fixed; bottom: 20px; right: 20px; background-color: #27ae60; color: white; padding: 15px 25px; border-radius: 6px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); align-items: center; z-index: 1000;">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">已複製到剪貼簿</span>
    </div>

    <script>
        const BASE_URL = 'https://tler123.github.io/test_resouces/';
        
        const FILE_CONFIG = {
            pdf: '2025年度_算法入門C++_第一次測驗.pdf',
            
            trip: [
                'trip1.in', 'trip1.ans',
                'trip2.in', 'trip2.ans', 
                'trip3.in', 'trip3.ans',
                'trip4.in', 'trip4.ans'
            ],
            
            buildings: [
                'buildings1.in', 'buildings1.ans',
                'buildings2.in', 'buildings2.ans',
                'buildings3.in', 'buildings3.ans',
                'buildings4.in', 'buildings4.ans',
                'buildings5.in', 'buildings5.ans',
                'buildings6.in', 'buildings6.ans'
            ],
            
            string: [
                'string1.in', 'string1.ans',
                'string2.in', 'string2.ans',
                'string3.in', 'string3.ans'
            ],
            
            knockout: [
                'knockout1.in', 'knockout1.ans',
                'knockout2.in', 'knockout2.ans',
                'knockout3.in', 'knockout3.ans',
                'knockout4.in', 'knockout4.ans'
            ]
        };

        const fileTree = document.querySelector('.file-tree');
        const fileTitle = document.getElementById('file-title');
        const filePath = document.getElementById('file-path');
        const actionButtons = document.getElementById('action-buttons');
        const copyAllBtn = document.getElementById('copy-all-btn');
        const filePreviewContainer = document.getElementById('file-preview-container');
        const filePreview = document.getElementById('file-preview');
        const previewStats = document.getElementById('preview-stats');
        const largeFileWarning = document.getElementById('large-file-warning');
        const sampleInfo = document.getElementById('sample-info');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const noFileSelected = document.getElementById('no-file-selected');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');

        let currentFile = null;
        let fileContent = '';

        function buildFileUrl(filename) {
            return BASE_URL + encodeURIComponent(filename);
        }

        function initFileTree() {
            fileTree.innerHTML = '';
            
            const pdfLi = document.createElement('li');
            pdfLi.className = 'pdf-link-item';
            const pdfUrl = buildFileUrl(FILE_CONFIG.pdf);
            pdfLi.innerHTML = `
                <a href="${pdfUrl}" class="pdf-link" target="_blank" onclick="event.stopPropagation();">
                    <div class="file-icon">
                        <i class="fas fa-file-pdf pdf-file"></i>
                    </div>
                    <div class="file-name pdf-file">${FILE_CONFIG.pdf}</div>
                </a>
            `;
            fileTree.appendChild(pdfLi);
            
            addFolderItem('trip', FILE_CONFIG.trip);
            addFolderItem('buildings', FILE_CONFIG.buildings);
            addFolderItem('string', FILE_CONFIG.string);
            addFolderItem('knockout', FILE_CONFIG.knockout);
        }

        function addFileItem(name, type, path) {
            const li = document.createElement('li');
            li.className = 'file-item';
            li.setAttribute('data-path', path);
            li.setAttribute('data-type', type);
            
            let icon = 'fa-file';
            let className = '';
            
            if (name.endsWith('.in')) {
                icon = 'fa-file-import';
                className = 'input-file';
                type = 'input';
            } else if (name.endsWith('.ans')) {
                icon = 'fa-file-export';
                className = 'output-file';
                type = 'output';
            }
            
            li.innerHTML = `
                <div class="file-icon">
                    <i class="fas ${icon} ${className}"></i>
                </div>
                <div class="file-name ${className}">${name}</div>
            `;
            
            li.addEventListener('click', () => selectFile(path, type, name));
            fileTree.appendChild(li);
        }

        function addFolderItem(folderName, files) {
            const li = document.createElement('li');
            li.className = 'file-item directory';
            li.innerHTML = `
                <div class="file-icon">
                    <i class="fas fa-folder"></i>
                </div>
                <div class="file-name">${folderName}</div>
            `;
            
            li.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleFolder(li, folderName, files);
            });
            
            fileTree.appendChild(li);
        }

        function toggleFolder(folderElement, folderName, files) {
            const isExpanded = folderElement.classList.contains('expanded');
            
            document.querySelectorAll('.file-item.expanded').forEach(item => {
                if (item !== folderElement) {
                    item.classList.remove('expanded');
                    const nextSibling = item.nextElementSibling;
                    if (nextSibling && nextSibling.classList.contains('folder-children')) {
                        nextSibling.remove();
                    }
                }
            });
            
            if (isExpanded) {
                folderElement.classList.remove('expanded');
                const childrenContainer = folderElement.nextElementSibling;
                if (childrenContainer && childrenContainer.classList.contains('folder-children')) {
                    childrenContainer.remove();
                }
            } else {
                folderElement.classList.add('expanded');
                
                const childrenContainer = document.createElement('div');
                childrenContainer.className = 'folder-children';
                childrenContainer.style.paddingLeft = '20px';
                
                files.forEach(fileName => {
                    const type = fileName.endsWith('.in') ? 'input' : 'output';
                    const childItem = document.createElement('div');
                    childItem.className = 'file-item';
                    childItem.setAttribute('data-path', fileName);
                    childItem.setAttribute('data-type', type);
                    
                    let icon = 'fa-file';
                    let className = '';
                    
                    if (fileName.endsWith('.in')) {
                        icon = 'fa-file-import';
                        className = 'input-file';
                    } else if (fileName.endsWith('.ans')) {
                        icon = 'fa-file-export';
                        className = 'output-file';
                    }
                    
                    childItem.innerHTML = `
                        <div class="file-icon">
                            <i class="fas ${icon} ${className}"></i>
                        </div>
                        <div class="file-name ${className}">${fileName}</div>
                    `;
                    
                    childItem.addEventListener('click', () => selectFile(fileName, type, fileName));
                    childrenContainer.appendChild(childItem);
                });
                
                folderElement.parentNode.insertBefore(childrenContainer, folderElement.nextSibling);
            }
        }

        async function selectFile(path, type, displayName) {
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const fileItem = document.querySelector(`[data-path="${path}"]`);
            if (fileItem) {
                fileItem.classList.add('active');
            }
            
            resetPreview();
            showLoading();
            
            fileTitle.textContent = displayName || path;
            filePath.textContent = `檔案: ${path}`;
            
            await loadFileContent(path, type, displayName || path);
        }

        async function loadFileContent(filePath, type, displayName) {
            try {
                const fileUrl = buildFileUrl(filePath);
                const response = await fetch(fileUrl, {
                    cache: 'no-cache',
                    headers: {
                        'Cache-Control': 'no-cache'
                    }
                });
                
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('檔案不存在');
                    } else {
                        throw new Error(`無法讀取檔案`);
                    }
                }
                
                fileContent = await response.text();
                const fileSize = response.headers.get('content-length') || fileContent.length;
                
                displayFileContent(fileContent, fileSize, type, displayName);
                actionButtons.style.display = 'flex';
                sampleInfo.style.display = 'block';
                
            } catch (err) {
                showError(`無法載入檔案 ${displayName}`, err, filePath);
                console.error('檔案載入錯誤:', err);
            } finally {
                hideLoading();
            }
        }

        function showLoading() {
            loading.style.display = 'flex';
            error.style.display = 'none';
            filePreviewContainer.style.display = 'none';
            largeFileWarning.style.display = 'none';
            actionButtons.style.display = 'none';
            sampleInfo.style.display = 'none';
            noFileSelected.style.display = 'none';
        }

        function hideLoading() {
            loading.style.display = 'none';
        }

        function displayFileContent(content, fileSize, type, filename) {
            const lines = content.split('\n').length;
            const chars = content.length;
            const sizeKB = Math.round(fileSize / 1024 * 100) / 100;
            
            previewStats.textContent = `${lines}行 ${chars}字元 ${sizeKB}KB`;
            
            // 檢查是否超過20000字元（行數不限）
            if (chars > 20000) {
                // 檔案太大，不顯示預覽
                filePreviewContainer.style.display = 'none';
                largeFileWarning.style.display = 'block';
            } else {
                // 檔案在限制內，顯示預覽
                largeFileWarning.style.display = 'none';
                filePreviewContainer.style.display = 'flex';
                filePreview.textContent = content;
            }
        }

        function showError(message, err, filename) {
            const fileUrl = buildFileUrl(filename);
            
            error.style.display = 'block';
            error.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <i class="fas fa-exclamation-triangle"></i> ${message}
                </div>
                <div style="font-size: 0.9rem; color: #666;">
                    檔案: ${filename}<br>
                    URL: <a href="${fileUrl}" target="_blank">${fileUrl}</a>
                </div>
            `;
            
            filePreviewContainer.style.display = 'none';
            largeFileWarning.style.display = 'none';
            actionButtons.style.display = 'none';
            sampleInfo.style.display = 'none';
        }

        function resetPreview() {
            filePreview.textContent = '';
            previewStats.textContent = '';
            filePreviewContainer.style.display = 'none';
            largeFileWarning.style.display = 'none';
            noFileSelected.style.display = 'none';
        }

        copyAllBtn.addEventListener('click', async () => {
            if (fileContent) {
                try {
                    await navigator.clipboard.writeText(fileContent);
                    
                    notificationText.textContent = '已複製到剪貼簿';
                    notification.style.display = 'flex';
                    
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 2500);
                } catch (err) {
                    const textarea = document.createElement('textarea');
                    textarea.value = fileContent;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    
                    notificationText.textContent = '已複製到剪貼簿';
                    notification.style.display = 'flex';
                    
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 2500);
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            initFileTree();
        });
    </script>
</body>
</html>